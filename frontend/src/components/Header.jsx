import { useState, useContext } from "react";
import axios from "axios";
import { Link, useNavigate } from "react-router-dom";
import { show } from "../state/shoppingCard";
import { useDispatch, useSelector } from "react-redux";
import  context  from "../Context/AppContext";

const Header = () => {
    const [isVisile, setClicked] = useState(false);
    const { info } = useContext(context); //get the login state and user role
    const isShown = useSelector((state) => state.shopcard.isShown);
    const dispatch = useDispatch();
    const Navigate = useNavigate();
    //
    axios.defaults.withCredentials = true;
    const handleDelete = () => {
        axios
            .get("http://localhost:5000/logout")
            .then((res) => {
                if (res.status === 200) {Navigate('/');location.reload()}
            })
            .catch((err) => {
                console.error(err);
            });
    };
    //
    return (
        <header className="text-blue-500 text-lg font-medium capitalize flex   max-sm:flex-col justify-between w-full sm:items-center shadow-md sm:px-3 py-5 lg:px-12">
            <span className="text-sm px-1">
                <svg
                    width="559.65"
                    height="126.76175963714459"
                    viewBox="0 0 369.66666666666663 83.73018341081827"
                    className="looka-1j8o68f h-[60px] min-w-10 w-[150px] max-md:w-[120px] lg:w-[190px]"
                >
                    <defs id="SvgjsDefs1179"></defs>
                    <g
                        id="SvgjsG1180"
                        transform="matrix(1.3696333169937134,0,0,1.3696333169937134,-7.637707750148258,-7.446306063302405)"
                        fill="#111111"
                    >
                        <path
                            xmlns="http://www.w3.org/2000/svg"
                            d="M45.32,50.11H26.71c-2.62,0-2.62,3.94,0,3.94h18.61C47.94,54.04,47.94,50.11,45.32,50.11L45.32,50.11z M11.2,42.83  c-0.36,0.24-0.48,0.72-0.24,0.95c0.24,0.36,0.72,0.48,1.07,0.24l4.06-2.98c0.36-0.24,0.36-0.6,0.12-0.95  c-0.12-0.36-0.6-0.36-0.95-0.24L11.2,42.83z M6.43,19.81c-0.36,0-0.83,0.24-0.83,0.6c-0.12,0.48,0.24,0.83,0.6,0.83l5.01,0.83  c0.36,0.12,0.72-0.12,0.83-0.6c0-0.36-0.24-0.72-0.6-0.83L6.43,19.81z M6.31,31.02c-0.36,0.12-0.6,0.48-0.48,0.95  c0,0.36,0.48,0.6,0.83,0.48l4.89-0.95c0.36-0.12,0.72-0.48,0.6-0.83c-0.12-0.48-0.48-0.72-0.83-0.6L6.31,31.02z M11.32,8.12  C10.96,7.88,10.61,8,10.37,8.36c-0.24,0.36-0.12,0.72,0.12,0.95l4.29,2.86c0.36,0.12,0.72,0.12,0.95-0.24  c0.24-0.36,0.12-0.83-0.24-1.07L11.32,8.12z M60.82,42.83c0.36,0.24,0.36,0.72,0.12,0.95c-0.24,0.36-0.6,0.48-0.95,0.24l-4.17-2.98  c-0.24-0.24-0.36-0.6-0.12-0.95c0.24-0.36,0.72-0.36,0.95-0.24L60.82,42.83z M65.59,19.81c0.36,0,0.72,0.24,0.83,0.6  c0,0.48-0.24,0.83-0.6,0.83l-5.01,0.83c-0.36,0.12-0.83-0.12-0.83-0.6c-0.12-0.36,0.24-0.72,0.6-0.83L65.59,19.81z M65.59,31.02  c0.36,0.12,0.6,0.48,0.6,0.95c-0.12,0.36-0.48,0.6-0.83,0.48l-5.01-0.95c-0.36-0.12-0.6-0.48-0.6-0.83c0.12-0.48,0.48-0.72,0.95-0.6  L65.59,31.02z M60.58,8.12c0.36-0.24,0.83-0.12,1.07,0.24c0.24,0.36,0.12,0.72-0.24,0.95l-4.17,2.86c-0.36,0.12-0.83,0.12-1.07-0.24  c-0.24-0.36-0.12-0.83,0.24-1.07L60.58,8.12z M30.17,60.96c0.12,3.22,2.74,5.61,5.84,5.61l0,0c3.1,0,5.73-2.5,5.84-5.61H30.17z   M27.54,55.59c-2.5,0-2.5,3.94,0.12,3.94h16.7c2.5,0,2.62-3.94,0-3.94H27.54z M26.71,48.56h8.59v-4.41  c-0.48-0.12-0.95-0.36-1.31-0.72c-0.48-0.48-0.83-1.19-0.83-2.03c0-0.72,0.36-1.43,0.83-1.91c0.48-0.6,1.19-0.83,2.03-0.83  c0.72,0,1.43,0.24,1.91,0.83c0.6,0.48,0.83,1.19,0.83,1.91c0,0.83-0.24,1.55-0.83,2.03c-0.36,0.36-0.72,0.6-1.19,0.72v4.41h8.59  c0.12,0,0.36,0.12,0.6,0.12c0.12-4.17,0.95-5.84,4.41-10.38c2.03-2.62,4.06-5.37,4.89-9.54c0.72-3.82,0.24-7.87-1.19-11.45  c-1.07-2.5-2.62-4.65-4.65-6.56c-7.63-7.28-19.68-7.04-27.19,0.48c-3.58,3.46-5.84,8.35-5.84,13.84c0,6.32,2.74,9.9,5.25,13.24  c3.7,4.77,4.41,6.56,4.53,10.38C26.35,48.67,26.47,48.56,26.71,48.56L26.71,48.56z M27.42,35.79c0.36,1.31,1.55,2.27,3.1,2.27  c1.67-0.12,2.98-1.55,2.86-3.22c0-1.19-0.72-2.15-1.79-2.62c-0.83-0.48-0.24-1.79,0.6-1.31c0.36,0.12,0.72,0.36,0.95,0.6h0.12  c0.95-1.07,1.19-2.74,0.6-4.06c-0.12-0.24-0.24-0.48-0.36-0.72c-0.6,0.6-1.43,0.95-2.27,1.19c0,0.36-0.12,0.83-0.24,1.19  c-0.48,0.95-1.79,0.36-1.43-0.6c0.36-0.72,0.12-1.55-0.48-2.03c-0.72-0.6,0.24-1.67,0.95-1.07c0.36,0.24,0.6,0.6,0.83,1.07  c1.31-0.24,2.39-1.19,2.86-2.5c0.36-1.07,0.24-2.27-0.36-3.22c-0.36-0.48-0.72-0.95-1.19-1.19c-0.48,0.12-0.95,0.24-1.43,0.36  c-0.6,0-1.07-0.12-1.67-0.24c-0.83-0.24-0.48-1.67,0.48-1.43c0.36,0.12,0.72,0.24,1.07,0.12c1.91,0,3.22-1.67,3.22-3.46  c-0.12-1.79-1.67-3.22-3.58-3.22c-1.19,0.12-2.39,0.95-2.86,2.03h0.12c0.36,0.12,0.6,0.24,0.95,0.48c0.24-0.24,0.48-0.48,0.83-0.6  c0.83-0.36,1.43,0.95,0.6,1.31c-0.6,0.24-0.83,0.83-0.83,1.43c0.12,0.95-1.31,1.19-1.43,0.24c0-0.36,0-0.83,0.12-1.19  c-0.24-0.12-0.48-0.12-0.72-0.24c-0.95-0.36-2.15-0.12-2.98,0.72c-0.6,0.6-1.07,1.43-0.95,2.39c0,0.83,0.36,1.55,0.95,2.15  c0.72,0.6-0.24,1.67-0.95,1.07c-0.24-0.24-0.48-0.6-0.72-0.83c-1.07,0.72-1.79,1.91-1.67,3.34c0.12,2.03,1.91,3.7,3.94,3.58  c0.95,0,1.07,1.43,0.12,1.43c-0.72,0-1.43-0.12-2.15-0.36c-0.36,0.72-0.6,1.43-0.6,2.27c0.12,2.03,1.79,3.58,3.82,3.58  c0-0.36,0.12-0.72,0.24-1.07c-0.24-0.24-0.48-0.48-0.6-0.83c-0.48-0.83,0.83-1.43,1.31-0.6c0.24,0.6,0.83,0.83,1.43,0.83  c0.95-0.12,1.07,1.31,0.12,1.43c-0.36,0-0.72,0-1.07-0.12C27.19,34.72,27.19,35.2,27.42,35.79L27.42,35.79z M34.46,25.65  c0.36,0.36,0.6,0.72,0.72,1.19c0.95,1.91,0.48,4.17-0.95,5.73c0.36,0.72,0.6,1.43,0.6,2.15c0.12,2.5-1.79,4.65-4.29,4.77  c-1.19,0.12-2.39-0.36-3.22-1.19c-0.72-0.6-1.19-1.43-1.43-2.27c-2.74,0-5.13-2.27-5.25-5.01c0-1.07,0.24-2.15,0.83-2.98  c-1.31-0.95-2.15-2.39-2.15-4.06c-0.12-1.91,0.83-3.7,2.5-4.65c-0.12-0.36-0.12-0.72-0.12-1.07c-0.12-2.5,1.79-4.53,4.29-4.65l0,0  l0,0c0.6-1.91,2.27-3.22,4.29-3.34c2.62-0.12,4.89,1.91,5.01,4.65c0,1.43-0.6,2.86-1.79,3.82c0.48,0.36,0.83,0.83,1.07,1.19  c0.83,1.31,1.07,2.98,0.48,4.53C34.94,24.94,34.7,25.3,34.46,25.65L34.46,25.65z M25.52,22.55c-0.95-0.12-0.72-1.55,0.24-1.43  c0.24,0,0.36,0,0.6,0c0.95,0,0.95,1.43,0,1.43C26.11,22.67,25.87,22.55,25.52,22.55L25.52,22.55z M36.97,40.44  c-0.24-0.24-0.6-0.36-0.95-0.36c-0.36,0-0.72,0.12-0.95,0.36c-0.24,0.24-0.48,0.6-0.48,0.95s0.24,0.72,0.48,0.95  c0.24,0.24,0.6,0.48,0.95,0.48c0.36,0,0.72-0.24,0.95-0.48c0.24-0.24,0.36-0.6,0.36-0.95S37.2,40.68,36.97,40.44L36.97,40.44z   M46.39,22.55c-0.24,0-0.6,0.12-0.83,0c-0.95,0-0.83-1.43,0.12-1.43c0.12,0,0.36,0,0.6,0C47.1,21,47.34,22.43,46.39,22.55  L46.39,22.55z M37.44,25.65c-0.24-0.36-0.48-0.72-0.6-1.19c-0.48-1.55-0.36-3.22,0.6-4.53c0.24-0.36,0.6-0.83,0.95-1.19  c-1.19-0.95-1.79-2.39-1.67-3.82c0.12-2.74,2.27-4.77,5.01-4.65c1.91,0.12,3.58,1.43,4.29,3.34l0,0l0,0  c2.39,0.12,4.29,2.15,4.29,4.65c0,0.36-0.12,0.72-0.24,1.07c1.67,0.95,2.62,2.74,2.62,4.65c-0.12,1.67-0.95,3.1-2.15,4.06  c0.48,0.83,0.83,1.91,0.72,2.98c-0.12,2.74-2.39,5.01-5.25,5.01c-0.24,0.83-0.72,1.67-1.43,2.27c-0.83,0.83-1.91,1.31-3.22,1.19  c-2.5-0.12-4.41-2.27-4.29-4.77c0-0.72,0.24-1.43,0.72-2.15c-1.55-1.55-1.91-3.82-1.07-5.73C36.97,26.37,37.2,26.01,37.44,25.65  L37.44,25.65z M44.6,35.79c0.12-0.6,0.12-1.07,0-1.67c-0.36,0.12-0.72,0.12-1.07,0.12c-0.83-0.12-0.72-1.55,0.12-1.43  c0.72,0,1.19-0.24,1.55-0.83c0.36-0.83,1.67-0.24,1.31,0.6c-0.24,0.36-0.36,0.6-0.6,0.83c0.12,0.36,0.24,0.72,0.24,1.07  c1.91,0,3.58-1.55,3.7-3.58c0-0.83-0.12-1.55-0.6-2.27c-0.6,0.24-1.31,0.36-2.03,0.36c-0.95,0-0.95-1.43,0-1.43  c2.15,0.12,3.94-1.55,3.94-3.58c0.12-1.43-0.48-2.62-1.67-3.34c-0.12,0.24-0.36,0.6-0.72,0.83c-0.6,0.6-1.67-0.48-0.95-1.07  c0.6-0.6,0.95-1.31,1.07-2.15c0-0.95-0.36-1.79-1.07-2.39c-0.72-0.83-1.91-1.07-2.98-0.72c-0.24,0.12-0.48,0.12-0.6,0.24  c0,0.36,0.12,0.83,0,1.19c-0.12,0.95-1.55,0.72-1.43-0.24c0.12-0.6-0.24-1.19-0.72-1.43c-0.95-0.36-0.36-1.67,0.6-1.31  c0.24,0.12,0.6,0.36,0.72,0.6c0.36-0.24,0.72-0.36,1.07-0.48l0,0c-0.48-1.07-1.55-1.91-2.86-2.03c-1.79,0-3.46,1.43-3.46,3.22  c-0.12,1.79,1.31,3.46,3.1,3.46c0.48,0.12,0.83,0,1.19-0.12c0.83-0.24,1.31,1.19,0.36,1.43c-0.48,0.12-1.07,0.24-1.55,0.24  c-0.48-0.12-1.07-0.24-1.43-0.36c-0.48,0.24-0.95,0.72-1.19,1.19c-0.6,0.95-0.83,2.15-0.36,3.22c0.36,1.31,1.43,2.27,2.74,2.5  c0.24-0.48,0.6-0.83,0.95-1.07c0.72-0.6,1.55,0.48,0.83,1.07c-0.6,0.48-0.72,1.31-0.48,2.03c0.36,0.95-0.95,1.55-1.31,0.6  c-0.12-0.36-0.24-0.83-0.24-1.19c-0.83-0.24-1.67-0.6-2.39-1.19c-0.12,0.24-0.24,0.48-0.36,0.72c-0.6,1.31-0.24,2.98,0.72,4.06l0,0  c0.36-0.24,0.6-0.48,0.95-0.6c0.83-0.48,1.55,0.83,0.6,1.31c-0.95,0.48-1.67,1.43-1.79,2.62c0,1.67,1.31,3.1,2.98,3.22  C42.93,38.06,44.12,37.1,44.6,35.79L44.6,35.79z"
                        ></path>
                    </g>
                    <g
                        id="SvgjsG1181"
                        transform="matrix(3.3661532402038574,0,0,3.3661532402038574,98.96061590779135,-1.7256570441146302)"
                        fill="#111111"
                    >
                        <path d="M4.42 17.04 l5.74 0 l0 2.96 l-6.14 0 l-2.82 0 l0 -14 l3.22 0 l5.56 0 l0 2.96 l-5.56 0 l0 2.54 l4.16 0 l0 2.9 l-4.16 0 l0 2.64 z M15.24 5.859999999999999 l0 14.14 l-3.16 0 l0 -14.14 l3.16 0 z M22.44 9.42 c2.36 0 5.66 1.78 5 6.48 l-7.26 0 c0.36 1.08 1.3 1.64 2.56 1.64 c1.28 0 1.68 -0.28 2.4 -0.58 l1.74 1.68 c-0.92 0.9 -2.16 1.56 -4.26 1.56 c-2.58 0 -5.66 -1.78 -5.66 -5.36 c0 -3.64 3.12 -5.42 5.48 -5.42 z M22.44 12.120000000000001 c-0.9 0 -1.82 0.52 -2.22 1.56 l4.42 0 c-0.32 -1.04 -1.3 -1.56 -2.2 -1.56 z M34.36 9.42 c1.9 0 3.5 0.8 4.48 2.48 l-2.4 1.14 c-0.52 -0.44 -0.94 -0.84 -2.04 -0.84 c-1.2 0 -2.42 0.92 -2.42 2.62 c0 1.68 1.22 2.56 2.42 2.56 c1.1 0 1.52 -0.36 2.04 -0.8 l2.44 1.14 c-1.02 1.68 -2.58 2.44 -4.52 2.44 c-2.32 0 -5.44 -1.66 -5.44 -5.34 c0 -3.62 3.12 -5.4 5.44 -5.4 z M45.56 17.36 c0.56 0 0.96 -0.08 1.4 -0.2 l0 2.62 c-0.44 0.2 -1.16 0.34 -2.22 0.34 c-1.74 0 -3.2 -0.58 -3.2 -3.78 l0 -4.14 l-1.46 0 l0 -2.6 l1.46 0 l0 -2.44 l3.16 0 l0 2.44 l2.22 0 l0 2.6 l-2.22 0 l0 4.14 c0 0.46 0.12 1.02 0.86 1.02 z M55.32000000000001 9.44 c0.28 0 0.56 0 0.82 0.06 l0 3.02 c-0.24 -0.06 -0.52 -0.06 -0.72 -0.06 c-1.92 0 -3.46 1.38 -3.62 3.3 l0 4.24 l-3.16 0 l0 -10.4 l3.16 0 l0 2.54 c0.48 -1.56 1.68 -2.7 3.52 -2.7 z M62.92000000000001 9.42 c2.36 0 5.48 1.78 5.48 5.42 c0 3.66 -3.12 5.36 -5.48 5.36 s-5.48 -1.7 -5.48 -5.36 c0 -3.64 3.12 -5.42 5.48 -5.42 z M62.92000000000001 12.2 c-1.2 0 -2.42 0.92 -2.42 2.64 c0 1.66 1.22 2.58 2.42 2.58 s2.44 -0.92 2.44 -2.58 c0 -1.72 -1.24 -2.64 -2.44 -2.64 z M76.50000000000001 9.44 c1.94 0 3.92 1.3 3.92 4.6 l0 5.96 l-3.16 0 l0 -5.74 c0 -1.58 -0.54 -2.08 -1.54 -2.08 c-1.42 0 -2.24 1.38 -2.44 1.98 l0 5.84 l-3.16 0 l0 -10.4 l3.16 0 l0 1.8 c0.2 -0.5 1.26 -1.96 3.22 -1.96 z"></path>
                    </g>
                </svg>
            </span>
            <i
                onClick={() => setClicked((prev) => !prev)}
                className="absolute right-4 top-9 fa-solid fa-bars max-sm:absolute sm:hidden  text-xl "
            ></i>
            {/*  */}
            <div
                className={`flex sm:justify-between max-sm:mt-2 max-sm:flex-col max-sm:bg-light-thirdly sm:block max-sm:w-full transition-all  ${
                    /*isVisile ? "max-sm:left-[0px]" : "max-sm:left-[-200px]"*/ isVisile
                        ? "block"
                        : "hidden"
                }`}
            >
                <ul className="flex gap-6 max-sm:gap-4 max-sm:flex-col max-sm:p-3 sm:items-center  clamp-[15px-3cqw-20px]">
                    <li className="  ">
                        <Link to={`/`}>home</Link>
                    </li>
                    <li className="  ">
                        <Link to={`/products`}>products</Link>
                    </li>
                    <li className="  ">
                        <Link to={`/views`}>Views</Link>
                    </li>
                    {info.userRole === "admin" && info.login && (
                        <li className="  ">
                            <Link to={`/admin`}>crud</Link>
                        </li>
                    )}
                    {
                        //if the user is log in show the log out button instead of the log in one
                        !info.login ? (
                            <li className="  ">
                                <Link to={`/login`}>
                                    <button className="bg-blue-500 text-white px-4 py-2 rounded">
                                        Log in
                                    </button>
                                </Link>
                            </li>
                        ) : (
                            <li>
                                <button
                                    onClick={handleDelete}
                                    className="bg-blue-500 text-white px-4 py-2 rounded"
                                >
                                    Log out
                                </button>
                            </li>
                        )
                    }
                    <li className="  ">
                        <button
                            className="fa-solid fa-bag-shopping text-[25px]"
                            onClick={() => {
                                isShown ? "" : dispatch(show());
                            }}
                        ></button>
                    </li>
                </ul>
            </div>
        </header>
    );
};

export default Header;
